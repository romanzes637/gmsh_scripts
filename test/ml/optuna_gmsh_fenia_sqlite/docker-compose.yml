version: "3.8"
services:
  opt:
    image: 10.254.55.75/fenia_gmsh
    build: .
    working_dir: /opt/gmsh/test/ml/optuna_gmsh_fenia_sqlite
    command: ["python", "/opt/gmsh/ml.py", "opt.json"]
    volumes:
      - tenex:/opt/gmsh/test/ml/optuna_gmsh_fenia_sqlite/opt
    deploy:
      mode: replicated
      replicas: 2
      placement:
        max_replicas_per_node: 1
#      resources:
#        limits:
#          cpus: '1.0'
#          memory: 8g
#        reservations:
#          cpus: '1.0'
#          memory: 4g

volumes:
  tenex:

