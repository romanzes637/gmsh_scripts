{
  "metadata": {
    "comments_algorithm_2d": "1: MeshAdapt, 2: Automatic, 3: Initial mesh only, 5: Delaunay, 6: Frontal-Delaunay (default), 7: BAMG, 8: Frontal-Delaunay for Quads, 9: Packing of Parallelograms",
    "comments_algorithms_3d": "1: Delaunay (default), 3: Initial mesh only, 4: Frontal, 7: MMG3D, 9: R-tree, 10: HXT",
    "comments_subdivision_algorithm": "0: none (default), 1: all quadrangles, 2: all hexahedra, 3: barycentric"
  },
  "data": {
    "key": "gmsh.parameter", "class": "action.Feature",
    "sub_actions": [
      {"key": "size", "class": "action.Feature",
        "sub_actions": [
          {"key": "curvature", "class": "action.Feature",
            "pre_call": {"class": "action.set.Discrete", "low": 80, "high": 200, "num": 121},
            "post_call": {"class": "action.get.Json", "path": "gmsh/container.json",
              "mapping": {"metadata": {"run": {"options": {"Mesh.MeshSizeFromCurvature": "{curvature}"}}}}}},
          {"key": "min", "class": "action.Feature",
            "pre_call": {"class": "action.set.Continuous", "low": 0, "high": 0.1},
            "post_call": {"class": "action.get.Json", "path": "gmsh/container.json",
              "mapping": {"metadata": {"run": {"options": {"Mesh.MeshSizeMin": "{min}"}}}}}},
          {"key": "max", "class": "action.Feature",
            "pre_call": {"class": "action.set.Continuous", "low": 0.1, "high": 5},
            "post_call": {"class": "action.get.Json", "path": "gmsh/container.json",
              "mapping": {"metadata": {"run": {"options": {"Mesh.MeshSizeMax": "{max}"}}}}}},
          {"key": "factor", "class": "action.Feature",
            "pre_call": {"class": "action.set.Continuous", "low": 1.0, "high": 2.0},
            "post_call": {"class": "action.get.Json", "path": "gmsh/container.json",
              "mapping": {"metadata": {"run": {"options": {"Mesh.MeshSizeFactor": "{factor}"}}}}}},
          {"key": "boundary", "class": "action.Feature",
            "pre_call": {"class": "action.set.Discrete", "low": 1, "high": 2, "num": 2},
            "post_call": {"class": "action.get.Json", "path": "gmsh/container.json",
              "mapping": {"metadata": {"run": {"options": {"Mesh.MeshSizeExtendFromBoundary": "{boundary}"}}}}}}
      ]},
      {"key": "geometry", "class": "action.Feature",
        "sub_actions": [
          {"key": "cast_iron", "class": "action.Feature",
            "sub_actions": [
              {"key": "size", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 1.0, "high": 1.0}},
              {"key": "dz", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 0.235, "high": 0.235}},
              {"key": "dr", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 0.235, "high": 0.235}}
            ]},
          {"key": "container", "class": "action.Feature",
            "sub_actions": [
              {"key": "height", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 5.500, "high": 5.500}},
              {"key": "radius", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 1.450, "high": 1.450}},
              {"key": "number", "class": "action.Feature",
                "pre_call": {"class": "action.set.Discrete", "low": 8, "high": 8, "num": 1}},
              {"key": "per_borehole", "class": "action.Feature",
                "pre_call": {"class": "action.set.Discrete", "low": 2, "high": 2, "num": 1}},
              {"key": "per_borehole_plus_one", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation",
                  "equation": "{container.per_borehole_plus_one.per_borehole}+1"}}
            ]},
          {"key": "filling", "class": "action.Feature",
            "sub_actions": [
              {"key": "size", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 1.0, "high": 1.0}},
              {"key": "height", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation",
                  "equation": "{geometry.filling.height.container.height}-2*{geometry.filling.height.cast_iron.dz}"}},
              {"key": "radius", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation",
                  "equation": "{geometry.filling.radius.container.radius}-{geometry.filling.radius.cast_iron.dr}"}}
            ]},
          {"key": "ebs", "class": "action.Feature",
            "sub_actions": [
              {"key": "size", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 1.0, "high": 1.0}},
              {"key": "dz", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 1.0, "high": 2.0}},
              {"key": "dr", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 1.0, "high": 2.0}},
              {"key": "height", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation",
                  "equation": "{geometry.ebs.height.container.height}+2*{ebs.height.dz}"}},
              {"key": "radius", "class": "action.Feature",
                 "pre_call": {"class": "action.set.Equation",
                   "equation": "{geometry.ebs.radius.container.radius}+{ebs.radius.dr}"}}
            ]},
          {"key": "borehole", "class": "action.Feature",
            "sub_actions": [
              {"key": "constraint", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation",
                  "equation": "{geometry.borehole.constraint.container.number} % {geometry.borehole.constraint.container.per_borehole} == 0"}},
              {"key": "number", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation",
                  "equation": "int({geometry.borehole.number.container.number}/{geometry.borehole.number.container.per_borehole})"}},
              {"key": "number_plus_one", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation",
                  "equation": "{borehole.number_plus_one.number}+1"}},
              {"key": "height", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation",
                  "equation": "{geometry.borehole.height.ebs.height}*{geometry.borehole.height.container.per_borehole}"}},
              {"key": "delta", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation", "equation": "-{borehole.delta.height}/2"}},
              {"key": "dx", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 10, "high": 100}},
              {"key": "x", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation",
                  "equation": "{borehole.x.dx}*{borehole.x.number}"}}
            ]},
          {"key": "rock", "class": "action.Feature",
            "sub_actions": [
              {"key": "size", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 10, "high": 10}},
              {"key": "dx", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 100, "high": 100}},
              {"key": "dy", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 100, "high": 100}},
              {"key": "dz", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 100, "high": 100}},
              {"key": "dnz", "class": "action.Feature",
                "pre_call": {"class": "action.set.Continuous", "low": 100, "high": 100}},
              {"key": "z", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation", "equation": "{rock.z.dz}+0.5*{geometry.rock.z.borehole.height}"}},
              {"key": "nz", "class": "action.Feature",
                "pre_call": {"class": "action.set.Equation", "equation": "{rock.nz.dnz}+0.5*{geometry.rock.nz.borehole.height}"}}
            ]},
          {"class": "action.get.Json", "path": "gmsh/cast_iron.json",
              "mapping": {"data": {
                "layer": [
                  ["{geometry.container.radius};{geometry.cast_iron.size}"],
                  ["{geometry.container.height};{geometry.cast_iron.size}"]]}}},
          {"class": "action.get.Json", "path": "gmsh/filling.json",
            "mapping": {"data": {
              "layer": [
                ["{geometry.filling.radius};{geometry.filling.size}"],
                ["{geometry.filling.height};{geometry.filling.size}"]]}}},
          {"class": "action.get.Json", "path": "gmsh/container.json",
            "mapping": {"data": {
              "children_transforms": [[[0, 0, "{geometry.cast_iron.dz}"]], []]}}},
          {"class": "action.get.Json", "path": "gmsh/borehole.json",
            "mapping": {"data": {
              "layer": [
                ["{geometry.ebs.radius};{geometry.ebs.size}"],
                ["{geometry.borehole.height}:{geometry.container.per_borehole_plus_one};{geometry.ebs.size}"]],
              "transforms": [[0, 0, "{geometry.borehole.delta}"]]}}},
          {"class": "action.get.Json", "path": "gmsh/boreholes.json",
            "mapping": {"data": {
              "matrix": [
                ["i",
                  "-{geometry.rock.dx};{geometry.rock.size}",
                  "{geometry.rock.dx};{geometry.rock.size}",
                  "{geometry.borehole.x}:{geometry.borehole.number_plus_one};{geometry.rock.size}",
                  "{geometry.rock.dx};{geometry.rock.size}"],
                ["-{geometry.rock.dy};{geometry.rock.size}", "{geometry.rock.dy};{geometry.rock.size}"],
                ["-{geometry.rock.nz};{geometry.rock.size}", "{geometry.rock.z};{geometry.rock.size}"]]}}}
        ]
      }
    ]
  }
}